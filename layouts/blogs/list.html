{{ define "main" }}

<section class="blogs-hero">
    <img src="/assets/imgs/blogs.png" alt="Blogs Hero Image" class="blogs-hero-image">
</section>

<div class="blogs-layout">

    <aside class="blog-sidebar">
        <h3>Categories</h3>

        <button class="filter-btn active" data-category="all">All</button>

        {{ $blogs := where site.RegularPages "Type" "blogs" }}
        {{ $allcats := slice }}

        {{ range $blogs }}
            {{ range .Params.categories }}
                {{ $allcats = $allcats | append . }}
            {{ end }}
        {{ end }}

        {{ range $allcats | uniq | sort }}
            <button class="filter-btn" data-category="{{ . | urlize }}">{{ . }}</button>
        {{ end }}
    </aside>

    <section class="blogs">
        <div class="blogs-grid">

            {{ range $blogs }}
            {{ $cats := .Params.categories | default (slice) }}

            <a href="{{ .RelPermalink }}"
               class="blog-card"
               data-categories="{{ range $i, $c := $cats }}{{ if $i }},{{ end }}{{ $c | urlize }}{{ end }}">

                {{ with .Params.featured_image }}
                <img src="{{ . }}" alt="{{ $.Title }}" class="blog-image">
                {{ end }}

                <h2>{{ .Title }}</h2>
                <p>{{ .Summary }}</p>

                {{ if $cats }}
                <p><strong>Categories:</strong> {{ delimit $cats ", " }}</p>
                {{ end }}

            </a>
            {{ end }}

        </div>
    </section>

</div>

<style>
.blogs-hero { text-align:center; margin-bottom:2rem; }
.blogs-hero-image { max-width:100%; height:auto; border-radius:10px; }

.blogs-layout { display:grid; grid-template-columns:240px 1fr; gap:2rem; }

.blog-sidebar { border-right:1px solid #ddd; padding-right:1rem; }
.filter-btn { width:100%; padding:10px; margin-bottom:6px; background:#eaf5f5; border:none; border-radius:6px; cursor:pointer; text-align:left; }
.filter-btn.active, .filter-btn:hover { background:#2a6b6b; color:white; }

.blogs-grid { display:grid; grid-template-columns:repeat(auto-fit, minmax(280px,1fr)); gap:25px; }
.blog-card { display:block; background:white; border:1px solid #ddd; border-radius:10px; padding:20px; text-decoration:none; color:#2a6b6b; box-shadow:0 1px 4px rgba(0,0,0,0.12); transition:transform .2s, box-shadow .2s; }
.blog-card:hover { transform:translateY(-6px); box-shadow:0 8px 20px rgba(0,0,0,0.15); }
.blog-image { width:100%; height:180px; border-radius:8px; object-fit:cover; margin-bottom:15px; }
</style>

<script>
document.addEventListener("DOMContentLoaded", () => {
    const buttons = document.querySelectorAll(".filter-btn");
    const cards = document.querySelectorAll(".blog-card");

    buttons.forEach(btn => {
        btn.addEventListener("click", () => {
            const category = btn.dataset.category;

            buttons.forEach(b => b.classList.remove("active"));
            btn.classList.add("active");

            cards.forEach(card => {
                const cats = card.dataset.categories.split(",");
                if (category === "all" || cats.includes(category)) {
                    card.style.display = "";
                } else {
                    card.style.display = "none";
                }
            });
        });
    });
});
</script>

{{ end }}
